<!DOCTYPE html>
<html>

<head>
  <base href="/">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Conway background</title>
  <!-- <link rel="icon" href="img/favicon.png" type="image/png"> -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/2.0.0-rc.1/pure-min.css">
</head>

<body>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mithril/2.0.4/mithril.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/snap.svg/0.5.1/snap.svg-min.js"></script>
  <script>
    var root = document.body
    var board_width = 1920;

    // Utils
    function getRandomInt(max) {
      return Math.floor(Math.random() * Math.floor(max));
    }

    // Variable and parameters
    var BoardState = {
      squareSize: 0,
      size: {
        width: 0,
        height: 0
      },
      dimension: {
        width: 100,
        height: 100
      },
      gray_colors: [Snap.rgb(140, 140, 140), Snap.rgb(70, 70, 70), Snap.rgb(30, 30, 30), Snap.rgb(20, 20, 20), Snap.rgb(0, 0, 0)],
      blue_colors: [Snap.rgb(196, 238, 255)],
      stroke_color: "#000000",
      blue_pixels: [[0, 0], [1, 1], [10, 10], [11, 11], [20, 20], [21, 21]]
    }

    // board Object (aka. view)
    var Board = {
      oninit: function (vnode) {
        BoardState.size.width = vnode.attrs.board_width;
        BoardState.squareSize = BoardState.size.width / BoardState.dimension.width;
        BoardState.size.height = BoardState.dimension.height * BoardState.squareSize;
      },
      oncreate: function (vnode) {
        var sb = Snap(vnode.dom);

        for (let j = 0; j < BoardState.dimension.height; j++) {
          for (let i = 0; i < BoardState.dimension.width; i++) {
            let square = sb.rect(i * BoardState.squareSize, j * BoardState.squareSize, BoardState.squareSize, BoardState.squareSize);
            square.attr({ fill: BoardState.gray_colors[getRandomInt(BoardState.gray_colors.length)] });
            square.attr({ stroke: BoardState.stroke_color, strokeWidth: 1 });
          }
        }
        for (k = 0; k < BoardState.blue_pixels.length; k++) {
          let square = sb.rect(BoardState.blue_pixels[k][0] * BoardState.squareSize, BoardState.blue_pixels[k][1] * BoardState.squareSize, BoardState.squareSize, BoardState.squareSize);
          square.attr({ fill: BoardState.blue_colors[getRandomInt(BoardState.blue_colors.length)] });
          square.attr({ stroke: BoardState.stroke_color, strokeWidth: 1 });
        }
      },
      view: function (vnode) {
        return m("svg#board", { width: BoardState.size.width, height: BoardState.size.height });
      }
    }

    // DOM
    var Client = {
      view: function (vnode) {
        return m("main.main",
          m("div.pure-g", m(".pure-u-1", m(Board, { board_width: board_width })))
        )
      }
    }

    m.mount(root, Client)

  </script>
</body>

</html>